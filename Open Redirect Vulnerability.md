# Open Redirect Vulnerability

### O que é:

Esta vulnerabilidade ocorre quando um site tem um parâmetro de redirecionamento, e não o filtra corretamente. Assim, um atacante pode se aproveitar da confiabilidade de um usuário em um site e usá-lo para levar o mesmo para um site malicioso.

### Definição de parâmetros:

Inicialmente vamos definir o que são parâmetros, eles são métodos pelos quais se passam informações entre o cliente e o servidor. 

Um exemplo disso é esta URL: http://exemplo.com/search.php?query=teste

Neste caso o cliente está passando uma informação para o servidor, nela ele passa um parâmetro chamado "query" e um valor "teste", o servidor então, "pega" o parâmetro e decide o que fazer com ele, neste exemplo ele faz uma pesquisa no banco de dados por items que contenham "teste" no nome e os retorna para o usuário.

O exemplo acima é de um caso em que o parâmetro é passado via GET, mas ele também pode ser passado via POST, o último caso explicarei mais para frente.

### Funcionamento técnico:

A vulnerabilidade deste tópico ocorre quando um parâmetro de redirecionamento é passado para o servidor, e o mesmo redireciona o cliente sem verificar para onde, logo um atacante pode injetar em um site um parâmetro que levaria o usuário para um site malicioso. Exemplo:

http://exemplo.com/login.php?redirect=https://evil.com

O que pode levar o usuário a um site com a página de login igual ao de exemplo.com, e quando o mesmo logasse teria suas credenciais roubadas. Isso configura um clássico ataque de phishing.


### Exemplo:

Em 2015 um usuário, usou a plataforma de bug bounty "Hackerone", para reportar ao shopify esta vulnerabilidade, na qual a URL

https://app.shopify.com/services/google/themes/preview/supply--blue?domain_name=example.com

permitia redirecionar o cliente para qualquer domínio. O pesquisador recebeu uma recompensa de $500.

Este exemplo pode ser lido, em inglês [aqui.](https://hackerone.com/reports/101962)

### Como explorar:

Para explorar esta vulnerabilidade o pesquisador deve estar atento a URL procurando parâmetros com nomes do tipo, redirect, redirect_uri, domain_name e etc. O mesmo deve então, tentar substituir os valores por outros e ver como a aplicação reaguirá, caso ela não o redirecione para outros domínios sem ser o dela, tente pesquisar sub-domínios que não pertecem mais a empresa e tente acessá-los.